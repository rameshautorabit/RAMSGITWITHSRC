<apex:page standardController="Contact" extensions="ContactExtension" >

    <apex:form id="formId">
    
        <apex:pageBlock title="Create New Address" id="mainBlock" mode="edit">
        
        	<!-- BUTTONS -->        
            <apex:pageBlockButtons >
                <apex:commandButton action="{!addressExtension.insertNewAddress}" value="Save" rerender="mainBlock" />
                <apex:commandButton action="{!addressExtension.saveAndAddMore}" value="Save & New" rerender="mainBlock" />
                <apex:commandButton action="{!addressExtension.addressCancelAddNew}" value="Cancel" immediate="true"/>
            </apex:pageBlockButtons>        
            
            <!-- ERROR CONDITION -->
            <apex:pageBlockSection title="Error(s) have been found..." rendered="{!(addressExtension.hasErrors == true)}" collapsible="false" columns="1">
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="Error Description" for="errors"/>
                    <apex:outputPanel >
                        <apex:outputText value="{!addressExtension.errorMessage}" id="errors" style="color: red; width:100%"/>
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
            
            <!-- THIS IS THE EDITABLE BLOCK FOR USE IN EDIT MODE -->            
            <apex:pageBlockSection title="Customer Address section" columns="1">
	            <apex:inputField value="{!addressExtension.customerAddress.Is_Inactive__c}"></apex:inputField>
	            <apex:inputField value="{!addressExtension.customerAddress.Is_Principal_Address__c}"></apex:inputField>  
	            <apex:inputField value="{!addressExtension.customerAddress.Address_Type__c}"></apex:inputField>          
            </apex:pageBlockSection>
            
            <apex:pageBlockSection title="Address section" columns="1">
	            <apex:inputField value="{!addressExtension.address.Address_1__c}" required="true">
	            </apex:inputField>
				<apex:inputField value="{!addressExtension.address.Address_2__c}">
				</apex:inputField>
				<apex:inputField value="{!addressExtension.address.City__c}" required="true">
				</apex:inputField>
				<apex:inputField value="{!addressExtension.address.State__c}" required="true">
				</apex:inputField>
				<apex:inputField value="{!addressExtension.address.Zip__c}" required="true">
				</apex:inputField>
				<apex:inputField value="{!addressExtension.address.Country__c}" required="true">
				</apex:inputField>
				<apex:inputField value="{!addressExtension.address.Country_Code__c}" required="true">
				</apex:inputField>
            </apex:pageBlockSection>
            
		</apex:pageBlock>
		    
		<apex:pageBlock title="Edit Existing Address" id="searchBlock">
			<apex:pageBlockTable id="addedProducts" rendered="true" value="{!addressExtension.contactCustomerAddresses}" var="addr">
				<apex:column headerValue="Action">
        			<apex:outputLink value="{!URLFOR($Action.Address__c.Edit, addr.Address__c)}">Edit</apex:outputLink>
        		</apex:column>			
				<apex:column headerValue="Address 1">
        			<apex:outputText value="{!addr.Address__r.Address_1__c}"></apex:outputText>
        		</apex:column>
				<apex:column headerValue="Address 2">
        			<apex:outputText value="{!addr.Address__r.Address_2__c}"></apex:outputText>
        		</apex:column>
				<apex:column headerValue="City">
        			<apex:outputText value="{!addr.Address__r.City__c}"></apex:outputText>
        		</apex:column>
				<apex:column headerValue="State">
        			<apex:outputText value="{!addr.Address__r.State__c}"></apex:outputText>
        		</apex:column>
				<apex:column headerValue="Zip">
        			<apex:outputText value="{!addr.Address__r.Zip__c}"></apex:outputText>
        		</apex:column>
				<apex:column headerValue="Country">
        			<apex:outputText value="{!addr.Address__r.Country__c}"></apex:outputText>
        		</apex:column>
				<apex:column headerValue="Country Code">
        			<apex:outputText value="{!addr.Address__r.Country_Code__c}"></apex:outputText>
        		</apex:column>        		        	
				<apex:column headerValue="Is Primary">
        			<apex:inputcheckbox value="{!addr.Is_Principal_Address__c}" selected="True" disabled="true"></apex:inputcheckbox>
        		</apex:column>
				<apex:column headerValue="Type">
        			<apex:outputText value="{!addr.Address_Type__c}"></apex:outputText>
        		</apex:column>
				<apex:column headerValue="Inactive">
        			<apex:inputcheckbox value="{!addr.Is_Inactive__c}" selected="True" disabled="true"></apex:inputcheckbox>
        		</apex:column> 
        	</apex:pageBlockTable>
        </apex:pageBlock>
            				
	</apex:form>
</apex:page>